# Code Review & Quality Tools

This directory contains scripts and tools to help maintain code quality in the Thinkivo project.

## ü§ñ Automated Code Review Bot

The project includes GitHub Actions workflows that automatically review code changes:

### 1. **Android Build & Lint** (`.github/workflows/android-build-lint.yml`)
- Runs on every push and pull request
- Builds the Android APK
- Runs ktlint checks
- Auto-formats code when possible
- Posts summary comments on pull requests

### 2. **Code Review Bot** (`.github/workflows/code-review-bot.yml`)
- Provides detailed analysis of changed files
- Shows ktlint issues specific to your changes
- Gives code quality insights and recommendations
- Updates comments automatically on new commits

## üõ†Ô∏è Local Development Tools

### Code Review Script (`code-review.sh`)

Run a local code review analysis to see what the bot will find:

```bash
# Analyze changes against main branch
./scripts/code-review.sh

# Analyze changes against specific branch
./scripts/code-review.sh develop
```

**Features:**
- Analyzes only files you've changed
- Shows ktlint issues with file-specific breakdown
- Provides fix suggestions
- Color-coded output for easy reading

### Pre-commit Hook (`pre-commit-hook.sh`)

Install a pre-commit hook to catch issues before they reach the repository:

```bash
# Install the pre-commit hook
cp scripts/pre-commit-hook.sh .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit
```

**Features:**
- Runs ktlint on staged files before commit
- Auto-formats code when possible
- Prevents commits with unfixable issues
- Shows clear feedback on what needs attention

## üìã What the Bot Comments Include

### On Pull Requests:
1. **Build Status**: Whether the Android build succeeded
2. **Ktlint Summary**: Number of issues found
3. **Issue Details**: Specific problems in your changed files
4. **Fix Instructions**: How to resolve the issues
5. **Quality Insights**: File change statistics and recommendations

### Sample Bot Comment:
```markdown
# ü§ñ Ktlint Code Review Report

‚ö†Ô∏è **Code Style Issues Found**

Found 3 ktlint issues that should be addressed:

### Issues:
```
MainActivity.kt:15:1 Function name should start with a lowercase letter
App.kt:7:1 Wildcard import (cannot be auto-corrected)
```

### üîß How to fix:
1. Run `./gradlew ktlintFormat` to auto-fix most issues
2. For issues that can't be auto-fixed, please address them manually
3. Some generated files may be excluded from ktlint checks

---
*This comment was generated by the ktlint code review bot* ü§ñ
```

## üîß Manual Commands

### Check code style:
```bash
./gradlew ktlintCheck
```

### Auto-format code:
```bash
./gradlew ktlintFormat
```

### Build Android APK:
```bash
./gradlew :composeApp:assembleDebug
```

## üí° Best Practices

1. **Before Committing:**
   - Run `./scripts/code-review.sh` to see potential issues
   - Run `./gradlew ktlintFormat` to auto-fix formatting
   - Review and test your changes

2. **IDE Setup:**
   - Configure your IDE to use ktlint formatting rules
   - Enable format-on-save if supported

3. **Code Review Process:**
   - Focus on logic, architecture, and functionality during reviews
   - Let the bot handle code style and formatting
   - Address bot feedback before requesting review

4. **Continuous Integration:**
   - The build will not fail due to ktlint issues
   - Use bot feedback to improve code quality
   - Generated files are automatically excluded

## üöÄ Benefits

- **Consistent Code Style**: Automated formatting ensures consistency
- **Early Detection**: Catch issues before they reach main branch
- **Learning Tool**: See and understand Kotlin style guidelines
- **Time Saving**: Automated fixes reduce manual formatting work
- **Quality Metrics**: Track code quality improvements over time
